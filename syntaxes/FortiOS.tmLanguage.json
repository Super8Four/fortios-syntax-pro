{
    "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
    "name": "FortiOS Configuration",
    "patterns": [
        {
            "include": "#config-blocks"
        },
        {
            "include": "#commands"
        },
        {
            "include": "#strings"
        }
    ],
    "repository": {
        "config-blocks": {
            "patterns": [
                {
                    "name": "meta.config-block.fortios",
                    "begin": "\\bconfig\\s+(\\w+)\\b",
                    "end": "\\bend\\b",
                    "beginCaptures": {
                        "1": { "name": "keyword.command.fortios" }
                    },
                    "patterns": [
                        {
                            "include": "#commands"
                        }
                    ]
                },
                {
                    "name": "meta.edit-block.fortios",
                    "begin": "\\bedit\\s+",
                    "end": "\\bnext\\b",
                    "patterns": [
                        {
                            "include": "#commands"
                        }
                    ]
                }
            ]
        },
        "commands": {
            "patterns": [
                {
                    "name": "keyword.other.fortios",
                    "match": "\\b(set|show|get|edit|config|next|end)\\b"
                },
                {
                    "name": "constant.numeric.ip-address.fortios",
                    "match": "(\"?)(\\b(?:\\d{1,3}\\.){3}\\d{1,3}(?:\\s+(?:\\d{1,3}\\.){3}\\d{1,3}|/\\d{1,2})?\\b)\\1"
                },
                {
                    "name": "variable.parameter.fortios",
                    "match": "\\b\\w+(-\\w+)*\\b"
                }
            ]
        },
        "strings": {
            "name": "string.quoted.double.fortios",
            "begin": "\"",
            "end": "\"",
            "patterns": [
                {
                    "name": "constant.character.escape.fortios",
                    "match": "\\\\."
                }
            ]
        }
    },
    "scopeName": "source.fortios"
}
